document.addEventListener("DOMContentLoaded",function(){function e(e){["#player1-select","#player2-select"].forEach(t=>{const n=document.querySelector(t);n.innerHTML='<option value="">Select Player</option>';["QB","RB","WR","TE"].forEach(t=>{const o=e.filter(e=>e.position===t);if(o.length){const e=document.createElement("optgroup");e.label=t,o.sort((e,t)=>t.total_points-e.total_points).forEach(t=>{const n=document.createElement("option");n.value=t.id,n.textContent=`${t.name} (${t.team})`,e.appendChild(n)}),n.appendChild(e)}})})}function t(e,t){const n=document.getElementById("weekly-chart"),o=e.weekly_points.map((e,t)=>`Week ${t+1}`);if("dark"===s)var a=echarts.init(n,"dark-fresh-cut");else a=echarts.init(n);const i={tooltip:{trigger:"axis"},legend:{data:[e.name,t.name]},xAxis:{type:"category",data:o},yAxis:{type:"value",name:"Points"},series:[{name:e.name,type:"line",data:e.weekly_points,smooth:!0},{name:t.name,type:"line",data:t.weekly_points,smooth:!0}]};a.setOption(i),window.addEventListener("resize",()=>a.resize()),setTimeout(()=>a.resize(),0)}function n(e,t){const n={"Basic Stats":{points_per_game:"Points/Game",total_points:"Total Points",games_played:"Games Played",projected_points:"Projected Points"},"Consistency Metrics":{std_dev:"Std Deviation",floor:"Floor",ceiling:"Ceiling",consistency:"Consistency %"},"Position Context":{team_share:"League Team Points Share %",pos_avg_diff:"vs Position NFL Starter Avg"},"League Context":{percent_owned:"Roster %",percent_started:"Started %"}};["player1-stats","player2-stats"].forEach((o,s)=>{const a=0===s?e:t;let i=`\n                <div class="card-body">\n                    <h5 class="card-title">${a.name} (${a.position})</h5>\n                    <p class="card-text">Team: ${a.team}</p>\n            `;Object.entries(n).forEach(([e,t])=>{i+=`\n                    <div class="stat-group mb-3">\n                        <h6 class="border-bottom pb-2 mb-2">${e}</h6>\n                        ${Object.entries(t).map(([e,t])=>`\n                            <div class="row mb-1 ${"pos_avg_diff"===e&&a[e]>0?"text-success":"pos_avg_diff"===e&&a[e]<0?"text-danger":""}">\n                                <div class="col-7">${t}:</div>\n                                <div class="col-5 text-end">${"number"==typeof a[e]?e.includes("percent")||e.includes("consistency")||e.includes("share")?a[e].toFixed(1)+"%":a[e].toFixed(1):a[e]||"N/A"}</div>\n                            </div>\n                        `).join("")}\n                    </div>\n                `}),i+="</div>",document.getElementById(o).innerHTML=i})}let o=[];document.body.classList.contains("dark");let s=document.body.classList.contains("dark");fetch("/assets/json/player_comparison/players_2025.json").then(e=>e.json()).then(t=>{o=t,e(t)}),document.querySelector("#compare-btn").addEventListener("click",function(){const e=document.querySelector("#player1-select").value,s=document.querySelector("#player2-select").value;if(!e||!s)return void alert("Please select two players to compare");const a=o.find(t=>t.id===parseInt(e)),i=o.find(e=>e.id===parseInt(s));t(a,i),n(a,i),document.querySelector("#comparison-results").style.display="block"})});